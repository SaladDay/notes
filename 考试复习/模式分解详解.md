

模式分解详解：分解为3NF和分解为BCNF

 

**3NF**：不存在非主属性对码的传递函数依赖（3NF）或部分函数依赖（2NF）。

**BCNF：**对于关系模式R，如果每一个函数依赖的决定因素都包含键，则R属于BCNF范式。

## **一、3NF分解**

保持依赖和无损连接，但存在冗余

为了求解保持依赖，我们先要会求最小依赖集。保持函数依赖3NF分解算法重点是在求极小函数依赖集

【**例**】设关系模式R(ABCDE)上的函数依赖集F={A→BC, BCD→E, B→D, A→D, E→A}，将其分解成3NF并保持函数依赖.
 解：

**第一步**: 求F的极小依赖集F’

1. 将右部单一化：{A→B，A→C, BCD→E, B→D, A→D, E→A}（**此时需要把重复的元素删除**）

2. 依次删除依赖，是否能推出还原，如果能还原就删除

   ![image-20230611143437490](https://saladday-figure-bed.oss-cn-chengdu.aliyuncs.com/img/image-20230611143437490.png)

3. 去掉左边的冗余

   ![image-20230611143459966](https://saladday-figure-bed.oss-cn-chengdu.aliyuncs.com/img/image-20230611143459966.png)

4. 合并,将左边相同的进行合并:{A→B，A→C, BC→E, B→D, E→A}转化为{A→BC, BC→E, B→D, E→A}

得到极小依赖集F' = {A→BC, BC→E, B→D, E→A}



**第二步**: 找到依赖两侧都未出现的分成子集，将极小依赖集中的每个依赖变为子集

得到子集为{ABC}{BCE}{BD}{EA}

**第三步**：对于所有的子集，如果都不包含候选码，需要将任意一个候选码添加到子集里面

此例中A为候选键，已经在子集中。

**第四步**：如果一个模式被另一个模式包含，则去掉此被包含的模式。

此例中子集为{ABC}{BCE}{BD}{EA}，互相不包含。完成分解。

## **二、BCNF分解**

**第一步**：求出候选码

**第二步**：观察函数依赖集，如果左边没有包含候选码，则不满足条件

**第三步**：

用不满足条件的函数依赖（A->B）进行分解，这样分解之后就满足了

- R1=AB（这样就满足了）
- R2=（R-R1)∪A
- F2={…}去掉B的所有函数依赖，尽可能写全

**第四步**：对F2进行步骤1的计算

**第五步**：重复直到所有满足条件



### 例子：

设有关系模式R(A, B, C, D, E, G)上的函数依赖集为：F={ A一>B, B一>C, AD一>G, D一>E }。求解：

1. 候选键{A,D}，A->B不符合，分解A->B：R = (A,C,D,E,G);R'=(A,B)

   R'上的函数依赖为{A->B}，候选键为A，符合BCNF

   R上的函数依赖为{ AD一>G, D一>E,**A->C**}，候选键为{AD}，不符合BCNF，继续分解

   **要注意A->C是在F+中的，也要出现**

2. D->E不符合，分解D->E：R = (A,C,D,G);R'=(D,E)

   R‘上的函数依赖为{D->E}，候选键为D，符合BCNF

   R上的函数依赖为{AD->G,A->C},候选键为{AD}，不符合BCNF

3. A->C不符合，分解A->C:R = (A,D,G);R'=(A,C)

   R'上的函数依赖为{A->C}，候选键为A，符合BCNF

   R上的函数依赖为{AD->G},候选键为(AD)，符合BCNF

最后得到保持无损连接特征（但不保持函数依赖）的分解：{AB}{DE}{AC}{ADG}

